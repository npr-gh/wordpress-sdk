!function(){var t={703:function(t,o,e){"use strict";var r=e(414);function n(){}function a(){}a.resetWarningCache=n,t.exports=function(){function t(t,o,e,n,a,s){if(s!==r){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function o(){return t}t.isRequired=t;var e={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:o,element:t,elementType:t,instanceOf:o,node:t,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:a,resetWarningCache:n};return e.PropTypes=e,e}},697:function(t,o,e){t.exports=e(703)()},414:function(t){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},o={};function e(r){var n=o[r];if(void 0!==n)return n.exports;var a=o[r]={exports:{}};return t[r](a,a.exports,e),a.exports}e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,{a:o}),o},e.d=function(t,o){for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},e.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},function(){"use strict";const{get:t}=lodash,o=o=>t(window,"wordproofSdk.data"+(o?`.${o}`:""),{});var r=window.wp.apiFetch,n=e.n(r);async function a(t,o,e){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:200;try{const n=await t();return!!n&&(n.status===r?o(n):e(n))}catch(t){console.error(t.message)}}async function s(t){try{return await n()(t)}catch(t){return t.error&&t.status?t:t instanceof Response&&await t.json()}}const i=async()=>await a((async()=>await c()),(t=>t),(()=>!1)),c=async()=>await s({path:"wordproof/v1/oauth/destroy",method:"POST"});var p=window.wp.i18n;const d=(0,p.sprintf)(
/** Translators: %s expands to WordProof */
(0,p.__)("%s has successfully timestamped this page.","wordpress-timestamp"),"WordProof"),u=(0,p.sprintf)(
/** Translators: %s expands to WordProof */
(0,p.__)("%s failed to timestamp this page. Please check if you're correctly authenticated with WordProof and try to save this page again.","wordpress-timestamp"),"WordProof"),f=(0,p.sprintf)(
/** Translators: %s expands to WordProof */
(0,p.__)("You are out of timestamps. Please upgrade your account by opening the %s settings.","wordpress-timestamp"),"WordProof");var w=e(697),h=e.n(w);function l(t){const o=new window.CustomEvent(t);console.warn("Event dispatch: "+t),window.dispatchEvent(o)}const y=t=>{const{response:o,createSuccessNotice:e,createErrorNotice:r,postId:n}=t;if(null===o||200===o.status)return;const a={id:"wordproof-timestamp-notice"};o&&201===o.status?0===o.balance?r(f,a):(e(d,{type:"snackbar",id:"wordproof-timestamp-notice"}),m(n,o.hash)):r(u,a)},m=async(t,o)=>{setTimeout((async()=>{(await(async t=>s({path:`wordproof/v1/posts/${t}/timestamp/transaction/latest`,method:"GET"}))(t)).hash!==o&&l("wordproof:webhook:failed")}),1e4)};y.proptypes={timestampResponse:h().any.isRequired,createSuccessNotice:h().func.isRequired,createErrorNotice:h().func.isRequired,postId:h().number.isRequired};const{debounce:g}=lodash,{applyFilters:v}=wp.hooks;const{dispatch:b}=wp.data;$e.modules.hookUI.Base;class _ extends $e.modules.hookData.Base{constructor(t,o,e){super(),this.hook=t,this.id=o,this.callback=e}getCommand(){return this.hook}getId(){return this.id}apply(){return this.callback()}}function k(t){window.elementor.notifications.showToast({message:t})}(function(){const{setIsAuthenticated:t}=b("wordproof"),e=o("popup_redirect_authentication_url"),r=o("popup_redirect_settings_url");let n=null;const c=(t,o)=>{n=function(t,o){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:800,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const a=t.top.outerHeight/2+t.top.screenY-n/2,s=t.top.outerWidth/2+t.top.screenX-r/2;return t.open(o,e,`toolbar=no,\n\t\tlocation=no,\n\t\tdirectories=no,\n\t\tstatus=no,\n\t\tmenubar=no,\n\t\tresizable=no,\n\t\tcopyhistory=no,\n\t\twidth=${r},\n\t\theight=${n},\n\t\ttop=${a},\n\t\tleft=${s}`)}(window,t,o),n&&n.focus(),window.addEventListener("message",p,!1)},p=async t=>{const{data:e,source:r,origin:i}=t;if(i===o("origin")&&n===r)switch(console.warn("Post message: "+e.type),e.type){case"wordproof:oauth:granted":!1===await u(e)&&await d("wordproof:oauth:failed",!1);break;case"wordproof:oauth:failed":await d("wordproof:oauth:failed",!1);break;case"wordproof:oauth:denied":await d("wordproof:oauth:denied",!1);break;case"wordproof:webhook:success":await d("wordproof:oauth:success",!0);break;case"wordproof:webhook:failed":await d("wordproof:webhook:failed",!1);break;case"wordproof:settings:updated":await d("wordproof:settings:updated"),await(async()=>await a((async()=>await(async()=>await s({path:"wordproof/v1/settings",method:"GET"}))()),(t=>t),(()=>!1)))();break;case"wordproof:oauth:destroy":await d("wordproof:oauth:destroy",!1)}},d=async function(o){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;window.removeEventListener("message",p,!1),l(o),!1===e&&(await i(),t(!1)),!0===e&&t(!0),n.close()},u=async t=>{await a((()=>(async t=>{let{state:o,code:e}=t;return await s({path:"wordproof/v1/oauth/authenticate",method:"POST",data:{state:o,code:e}})})(t)),(async t=>{const e={type:"wordproof:sdk:access-token",source_id:t.source_id};return n.postMessage(e,o("origin")),!0}),(async t=>!1))};window.addEventListener("wordproof:open_authentication",(t=>{t.preventDefault(),c(e,"WordProof_Authentication")}),!1),window.addEventListener("wordproof:open_settings",(t=>{t.preventDefault(),c(r,"WordProof_Settings")}),!1)})(),function(t,e,r){t(g((async()=>{if(v("wordproof.timestamp",!0)){const t=o("current_post_id"),n=await(async t=>s({path:`wordproof/v1/posts/${t}/timestamp`,method:"POST"}))(t);y({response:n,createSuccessNotice:e,createErrorNotice:r,postId:t})}}),500))}((function(t){!function(t,o,e){$e&&$e.hooks.registerDataAfter(new _("document/save/save","wordproof/timestamper",e))}(0,0,(()=>{window.setTimeout(t,1e3)}))}),k,k)}()}();